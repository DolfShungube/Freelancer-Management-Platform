<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Freelancio</title>
  <link rel="stylesheet" href="admin.css" />
</head>
<body>

  <nav class="navigation">
    <h2 class="title">
      Freelancio.
      <img src="src/pages/images/coffee.png" class="logo" alt="coffee logo">
    </h2>
  </nav>

  <p class="greeting">
    Hi Shungube (Admin)
    <img class="profile-icon" src="src/pages/images/profile_picture.jpg" alt="Profile icon">
  </p>
  <section class="section-box">
    <h3 class="section-title">üë• Users</h3>
    <p class="no-tasks">No users yet.</p>
  </section>
  
  <section class="section-box">
    <h3 class="section-title">üõ°Ô∏è Admins</h3>
  
    <!-- List of Admins -->
    <p class="no-tasks">No admins yet.</p>
  
    <form id="adminForm" class="admin-form" style="display: none;" onsubmit="addAdmin(event)">
      <input type="text" id="adminFName" placeholder="Fist Name" required />
      <input type="text" id="adminLName" placeholder="Last Name" required />
      <input type="email" id="adminEmail" placeholder="Email" required />
      <select id="adminRole" required>
        <option value="">Select Admin role</option>
        <option value="Super Admin">Super Admin</option>
        <option value="Moderator">Moderator</option>
      </select>
      <button type="submit" class="add-btn">Submit</button>
    </form>
  
    <button class="add-btn" onclick="toggleForm()">Add Admin</button>
  </section>
  
  <script>
    const addedAdmins = new Set();

    function toggleForm() {
      const form = document.getElementById("adminForm");
      form.style.display = form.style.display === "none" ? "block" : "none";
    }

    function addAdmin(event) {
      event.preventDefault();
      const name = document.getElementById("adminFName").value.trim();
      const Lname = document.getElementById("adminLName").value.trim();
      const email = document.getElementById("adminEmail").value.trim().toLowerCase();
      const role = document.getElementById("adminRole").value;

      if (addedAdmins.has(email)) {
        alert("This admin has already been added.");
        return;
      }

      const adminSection = document.querySelector(".section-box:nth-of-type(2)");
      const noTasks = adminSection.querySelector(".no-tasks");
      if (noTasks) noTasks.remove();

      const newAdmin = document.createElement("p");
      newAdmin.style.marginTop = "10px";
      newAdmin.style.fontWeight = "500";

      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "üóëÔ∏è";
      deleteBtn.style.marginLeft = "10px";
      deleteBtn.style.background = "none";
      deleteBtn.style.border = "none";
      deleteBtn.style.cursor = "pointer";
      deleteBtn.style.fontSize = "1rem";
      deleteBtn.title = "Delete admin";

      // Handle the delete button click
      deleteBtn.onclick = function() {
        const confirmDelete = confirm("Are you sure you want to delete this admin?");
        if (confirmDelete) {
          adminSection.removeChild(newAdmin);

          // If no admins are left, show the "No admins yet" message
          if (adminSection.querySelectorAll("p").length === 1) {
            const emptyNote = document.createElement("p");
            emptyNote.className = "no-tasks";
            emptyNote.textContent = "No admins yet.";
            adminSection.insertBefore(emptyNote, adminSection.children[1]);
          }

          // Remove the admin from the addedAdmins set
          addedAdmins.delete(email);
        }
      };

      newAdmin.textContent = `${name} - ${email} (${role})`;
      newAdmin.appendChild(deleteBtn);

      // Insert the new admin above the form
      adminSection.insertBefore(newAdmin, document.getElementById("adminForm"));

      // Add this admin's email to the set to prevent duplicates
      addedAdmins.add(email);

      // Reset the form and hide it
      document.getElementById("adminForm").reset();
      document.getElementById("adminForm").style.display = "none";
    }
  </script>

</body>
</html>
